<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/styles.css">
    <script>
        async function toggleAccountStatus(userId, currentStatus) {
            const newStatus = !currentStatus; // 현재 상태 반대로 변경
            try {
                const response = await fetch(`/admin/users/${userId}/toggle-status`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ isActive: newStatus }) // 변경될 상태 전송
                });

                if (!response.ok) {
                    throw new Error('계정 상태 업데이트 실패');
                }

                // UI 업데이트
                const statusText = newStatus ? '활성화' : '비활성화';
                document.getElementById('account-status').textContent = statusText;
                document.getElementById('account-action-btn').textContent = newStatus ? '계정 정지' : '계정 활성화';
                document.getElementById('account-action-btn').setAttribute('onclick', `toggleAccountStatus(${userId}, ${newStatus})`);
                alert('계정 상태가 업데이트되었습니다.');
            } catch (error) {
                console.error(error);
                alert('계정 상태 업데이트 중 오류가 발생했습니다.');
            }
        }
    </script>
</head>
<body>
<div class="modal-content">

    <div>
        <p><strong>이름:</strong> <span th:text="${user.nickname}"></span></p>
    </div>

    <div>
        <p><strong>이메일:</strong> <span th:text="${user.email}"></span></p>
    </div>

    <div>
        <p><strong>계정 상태:</strong>
            <span th:text="${user.isActive} ? '활성화' : '비활성화'"></span>
        </p>
    </div>

    <div>
        <!-- 버튼은 초기 상태에 따라 다르게 표시 -->
        <button id="account-action-btn"
                th:text="${user.isActive} ? '계정 정지' : '계정 활성화'"
                onclick="toggleAccountStatus([[${user.userId}]], [[${user.isActive}]])">
        </button>
    </div>

</div>
